from ortools.linear_solver import pywraplp

solver = pywraplp.Solver.CreateSolver('SCIP')

import pandas as pd
import numpy as np
df = pd.read_excel("vds1.xlsx", 0)
df = df.drop(labels=range(0, 4), axis=0)
del df['Unnamed: 0']
df.head()
df1 = df.to_numpy()
df1
cost = df1
cost

vehicle_plate = len(cost)
product_code = len(cost[0])
print(vehicle_plate,  product_code)


from __future__ import print_function
import time
from ortools.linear_solver import pywraplp

def main():
  solver = pywraplp.Solver('SolveAssignmentProblem',
                           pywraplp.Solver.CBC_MIXED_INTEGER_PROGRAMMING)

  start = time.time()
  

  task_sizes = np.ones((152,), dtype=int)

  # Maximum total of task sizes for vehicle
  total_size_max = 8
  vehicle_plate = len(cost)
  product_code = len(cost[1])
  # Variables
  x = {}

  for i in range(vehicle_plate):
    for j in range(product_code):
      x[i, j] = solver.IntVar(0, 1, 'x[%i,%i]' % (i, j))

  # Constraints
  # The total size of the tasks each worker takes on is at most total_size_max.

  for i in range(vehicle_plate):
    solver.Add(solver.Sum([task_sizes[j] * x[i, j] for j in range(product_code)]) <= total_size_max)

  # Each task is assigned to at least one worker.

  for j in range(product_code):
    solver.Add(solver.Sum([x[i, j] for i in range(vehicle_plate)]) >= 1)

  solver.Maximize(solver.Sum([cost[i][j] * x[i,j] for i in range(vehicle_plate)
                                                  for j in range(product_code)]))
  sol = solver.Solve()

  print('Maksimum cost = ', solver.Objective().Value())
  print()
  for i in range(vehicle_plate):
    for j in range(product_code):
      if x[i, j].solution_value() > 0:
        print('Vehicle_plate', i,' assigned to customer', j, '  Value = ', cost[i][j])
  print()
  end = time.time()
  print("Time = ", round(end - start, 4), "seconds")
if __name__ == '__main__':
  main()
  
